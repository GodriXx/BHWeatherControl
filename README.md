# BHWeatherControl

## Requirements

- iOS 11.0+ 
- Xcode 12+
- Swift 5.0+

## ➡️ Pre-Requisites
This project has been developed with Swift 5.0, Xcode 12.3 and CocoaPods 1.8.3. So you must have Xcode installed on your computer and be sure you have at least this version of Cocoapod installed on your computer. To check if pod is available, lauch the following command :
```
pod --version
```
In case cocoapods is not installed or `pod` is not recognized by command line, run this command :
```
[sudo] gem install cocoapods --pre
```

## ➡️ Installation
1. Go to the root of the project on your computer
```
cd ~/YourProjectName
```
2. Create new podfile in the root of your project folder
```
pod init
```
3. Add the code below to your podfile
```ruby
target 'TargetName' do

  use_frameworks!

    pod 'BHWeatherControl', :git => 'https://github.com/GodriXx/BHWeatherControl.git'

end
```
4. Normally, pod dependencies are not ignored by `.gitignore`, as it's recommanded on iOS/Swift project (https://github.com/github/gitignore/blob/master/Swift.gitignore). But to be sure all you config files are up to date, launch the folowing command :
```
pod install
```
5. At this step, everything is ready to begin the develop phase, open the project on Xcode:
```
open YourProject.xcworkspace
```
6. At last, build the project from Xcode:
```
cmd + B
```
7. In case you face errors or warnings generated by `BHWeatherControl`, or incompatiblity issues after updating to new iOS/Swift version, due to fixed version to pods in your app podfile, please check new version of your target pod on official github, change version number to the new one and run command above.
```
pod update
```
8. Sometimes updating or installing pods doesn't take in consideration newest version even if you buff version number in podfile, to resolve this issue please delet `podfile.lock` and run following command :
```
pod deintegrate
pod install
```
9. Add new configuration entry in your application's `Info.plist`, type String and named `appID`, this key must contain your own OpenWeatherMap token.

## ➡️ Usage

- first import `BHWeatherControl`
- then call functions using shared object `WeatherProvider`

### Multiple simplified weathers
this will return an array of weather forecast with basic informations

```swift
import BHWeatherControl

let weatherProvider = WeatherProvider.shared
let locations = [Locations(lon: "48.8", lat: "2.25"), Locations(lon: "48.91", lat: "2.5")]

self.weatherProvider.getCurrentWeathers(locations: locations) { (weathers) in
    // Success
    // weathers is an array of [WeatherWrapper]
} onError: { (error) in
    // Failure
}
```

### Single detailed forecast
Get detailed weather forecast for single location
```swift
import BHWeatherControl

let weatherProvider = WeatherProvider.shared
let location = Locations(lon: "48.8", lat: "2.25")

self.weatherProvider.getWeatherDetails(location: location) { (weather) in
    // Success
    // weather is a single WeatherWrapper object containing all forecast details
} onError: { (error) in
    // Failure
}
```

## ➡️ Third party services
BHWeatherControl use `OpenWeatherMap` as data provider

## ➡️ Patterns used in App

### Decorator : 
Mainly represented with `Extensions` and `Delegation`, `Extension` is mechanism that allows you to add new functionality to existing classes, structures or enumeration types without having to subclass. `Delegation` is a mechanism in which one object acts on behalf of, or in coordination with, another object.

### Singleton : 
The Singleton design pattern ensures that only one instance exists for a given class and that there’s a global access point to that instance, the use of this model is extremely limited and to be avoided due to the lack of freedom of testability.

### Adapter : 
An Adapter allows classes with incompatible interfaces to work together. It wraps itself around an object and exposes a standard interface to interact with that object. Applying Adapter in iOS can be done throught defining protocols that can be implemented later in target classes, exemple DataSources


## ➡️ Architecture
Here will be explain all about folders, their content and the way they are implented and called each other.

### Constants
Contains multiple classes to manage needed configuration accros the project such as **Constants.swift**, this allow to store multiples configurations, and if needed multiple environnement.

### Extensions
As it’s name suggests, this folder contains only Extension for iOS SDK.

### Enums
Enums contains all enumerated and defined data.

### Models
Model are objects obtained via web service and distributed in the app. all model objects in BHWeatherControl are conform to `Codable` protocol, to realize mapping from `JSON` data to the object itself, and ObjectWrappers to simplify access to important data. They are structs.

### Services
Services represent one time instantiation class that are sharing by all providers components. They can keep states and sharing them. It’s here where the Web Services is managed, this layer contains a couples of  `Workers`  and `Routers` used to specify the API and it's parameters to be invoked.

### Providers
Providers are shared classes (Singleton) allows clients app to access functionnalities. 

### Config
Contains basic configuration shared across all classes as static variables.

## ➡️ Main Pods

This framework use only native swift code, no external frameworks.

## ➡️ Comments
Comments are present all over the app to explain some piece of code, difficulties, to do work or improvement that could come later. Some comments are prefixed with a specific syntax for a specific meanning :

- `// IMPROVEMENT` : Means the code could be more compact, more readable, more syntetic, etc. Contraily to the previous syntax, this kind of comment could not lead to crash or bug, it could just be improve and more efficient.
- `// TODO` : Means a task, a piece of logic or some treatments linked to a feature is missing and should be implemented soon.
- `// FIXME` : Means this part of code shoud be fixed as soon as possible, either because some other modules are still incompleted to fix it, or some improvements are possible
- `// WARNING` : Means the code could have an important impact on other app’s components or are badly developed and could lead to leaks, crashes, problems and so on. This kind of comments could also give some keys about a behaviour, logic choices, etc.

## ➡️ Unit Tests & UI Tests
BHWeatherControl uses iOS XCTest to validate application critical modules
tests are located in targets `BHWeatherControlTests`.
These tests could be automated using `Fastlane` and `gitlabCI` in futur improvements.

More options and descriptions can be found on fastlane official doc site: [Fastlane Scan](https://docs.fastlane.tools/actions/scan/).

### **Note**‼️: A faulty test could strongly occur after major changes, making test check mandatory,
also, after implementing new features, tests must be updated to latest specs, and new ones must be writen if needed.

## Perspectives
* Add bundle to include icons assets inside BHWeatherControl, and return them to clients.
* Add more security access to transactions, code and sensitive stored data using different techniques such as code obfuscation and Secure Enclave...
* Add support to multiple search criteria such as name and cityID.
